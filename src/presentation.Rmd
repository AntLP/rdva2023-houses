---
title: "Müè†d√©lisation üè°üèò"
author: "Antoine Lachance-Perreault"
date: "2023-04-21"
output:
  ioslides_presentation:
    # css: style.css
    # incremental: true
    widescreen: yes
    theme: yeti
    logo: logo.svg
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.width = 15,
  fig.height = 100/15,
  fig.retina = 3,
  out.width = "100%",
  cache = FALSE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  fig.showtext = FALSE,
  fig.align = "center",
  hiline = TRUE,
  dev.args = list(bg = "transparent")
)

PROMU_YELLOW <- "#fddb00"
PROMU_GREY = "#53565A"

library(kableExtra)
library(gt)
library(tidyverse)
library(tidymodels)
library(gtExtras)

theme_set(theme_bw())
```


```{r}
add_gt_tab_options <- function(gt_table){
  gt_table %>% 
    tab_options(
      table.background.color = "#FFFFFF00",
      # column_labels.font.size = px(10),
      column_labels.font.weight = "bold",
      # table.font.color = "#EEEEEE",
      table.font.size = px(11L)
    )
}
```


## Pr√©sentation du jeu de donn√©es

```{r}
read_rds("./assets/tbl_raw_data.rds") %>% 
  add_gt_tab_options()
```

<!-- # Analyse exploratoire des donn√©es -->

<!-- ## Prix affich√© -->

```{r}
# knitr::include_graphics("./assets/plot_price_density.png")
```


<!-- ## Prix par r√©gion -->

```{r}
# knitr::include_graphics("./assets/plot_price_region_boxplot.png")
```

# Premier mod√®le

## Premier mod√®le

```{r}
read_rds("./assets/tbl_raw_data.rds") %>% 
  tab_style(
    style = cell_fill("#9BE452", alpha = 0.5), 
    locations = list(cells_body("price"), cells_column_labels("price"))) %>% 
  tab_style(
    style = cell_fill(PROMU_YELLOW, alpha = 0.5),
    locations = list(cells_body(columns = 2:10), cells_column_labels(columns = 2:10))
  ) %>% 
  add_gt_tab_options()
```

## Premier mod√®le - R√©sultats

```{r}
knitr::include_graphics("./assets/plot_vip_model1.png")
```



<!-- ## Premier mod√®le - Performance -->

```{r}
# knitr::include_graphics("./assets/plot_AE_model1.png")
```



<!-- ## Premier mod√®le - Performance -->

```{r}
# knitr::include_graphics("./assets/plot_demo_lift.png")
```

## Premier mod√®le - Performance

```{r}
knitr::include_graphics("./assets/plot_lift_model1.png")
```



# Traitement de la description


<div class="notes">
Tr√®s riche en information, mais comme ce n'est pas structur√©, c'est difficile 

</div>




```{r}
tbl_keywords <- tribble(
  ~keyword, ~dir,
  "Bricoleur", "arrow-down",
  "Potentiel", "arrow-down",
  "R√©nov√©", "arrow-up",
  "Spacieux", "arrow-up"
) %>% 
  gt() %>% 
  cols_label(
    keyword = "Mon cl√©",
    dir = "Effet attendu"
  ) %>% 
  gt_fa_column(column = dir,
               palette = c("arrow-down" = "#E45252",
                           "arrow-up" = "#9BE452")) %>% 
  cols_align(align = "center",
             columns = dir)
```

## Indicateur de mot cl√©

Identifier certains mots cl√©s qui ont une influence sur le prix et faire des indicateurs de pr√©sence de ceux-ci dans la description.

```{r}
tbl_keywords
```

## Indicateur de mot cl√©

Enjeux:

* Ignore le contexte du mot cl√©:
  * "Compl√®tement r√©nov√©e en 2022"
  * "Devra √™tre r√©nov√©e en entier"
* Difficile de traiter les synonymes
* Mots rares et/ou erreurs de frappe
* Laborieux

## Vectorisation de mots

Id√©e g√©n√©rale:

* Techniques utilis√©es pour de repr√©senter un mot sous la forme d'un vecteur √† *n* dimension
* Les mots qui sont similaire pour la t√¢che donn√© vont avoir un vecteur similaire


## Vectorisation de mots

```{r, out.height=450, out.width = 600}
knitr::include_graphics("./assets/embedding_network.png")
```

## Vectorisation de mots

```{r, out.height=500, out.width = 500}
knitr::include_graphics("./assets/plot_exemple_embedding.png")
```


## Vectorisation de mots

Enjeux:

* √ânorm√©ment de donn√©es sont requises pour entra√Æner un tel mod√®le


## Vectorisation de mots

Enjeux:

* √ânorm√©ment de donn√©es sont requises pour entra√Æner un tel mod√®le

Solution:

* Utiliser un mod√®le d√©j√† entra√Æn√© (mais moins sp√©cialis√©)


## Repr√©sentation vectorielle continue

```{r}
read_rds("./tbl_embeddings.rds")
```

# Deuxi√®me mod√®le - Description uniquement

## Deuxi√®me mod√®le - R√©sultats

```{r}
knitr::include_graphics("./assets/plot_vip_model_embed.png")
```


## Deuxi√®me mod√®le - R√©sultats


```{r, out.height=450, out.width = 600}
knitr::include_graphics("./assets/wordcloud_low.png")
```


## Deuxi√®me mod√®le - R√©sultats

```{r, out.height=450, out.width = 600}
knitr::include_graphics("./assets/wordcloud_high.png")
```


## Deuxi√®me mod√®le - Performance

```{r}
knitr::include_graphics("./assets/plot_lift_by_lang.png")
```


## Shiny Presentation

This R Markdown presentation is made interactive using Shiny. The viewers of the presentation can change the assumptions underlying what's presented and see the results immediately. 

To learn more, see [Interative Documents](http://rmarkdown.rstudio.com/authoring_shiny.html).

<div class="notes">
This is my *note*.

- It can contain markdown
- like this list
</div>

## Slide with Interactive Plot

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),

  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")

  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```

## Slide with Interactive Plot

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks2", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),

  sliderInput("bw_adjust2", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks2),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")

  dens <- density(faithful$eruptions, adjust = input$bw_adjust2)
  lines(dens, col = "blue")
})
```
